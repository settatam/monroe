var siteUrl,pointerEvent="click",modelClose='<div class="lightClose"> </div>';$(function(){siteUrl=$("body").attr("data-site-url");var t=document.querySelectorAll(".pswp")[0],e=[];$(".image_collection .oneimage").each(function(t){if($(this).data("largeimg")){var i={src:$(this).data("largeimg"),w:$(this).data("img-w"),h:$(this).data("img-h"),title:$("figcaption",this).text()};e.push(i)}else{var a='<iframe frameborder="0" name="pswp_iframe" scrolling="no" src="'+$(this).data("iframe")+'"></iframe>',l={html:"<div class='pswp_fullscreen'><div class='pswp_iframe_holder'>"+a+"</div></div>",w:920,h:614,title:$("figcaption",this).text()};e.push(l)}});var i={index:0,closeOnScroll:!1};$(".js-openGallery").on(pointerEvent,function(a){var l=new PhotoSwipe(t,PhotoSwipeUI_Default,e,i);l.options.index=$(this).index(),l.init(),l.listen("beforeChange",function(){console.log("beforeChange")}),l.listen("afterChange",function(){console.log("afterChange")}),l.listen("destroy",function(){$(".pswp_iframe_holder").html("")})})});var normalizeURL=function(t,e){return t=t.replace(/^http[s]*:/i,""),/anvil2.tollwebservices.com/i.test(t)||/tollbrothers.com/i.test(t)||/www\.youtube\.com/i.test(t)||(t="//www.tollbrothers.com"+t),t};$(function(){$(".js-openSiteplan").on(pointerEvent,function(t){var e=document.querySelectorAll(".pswp")[0],i=[];$(".siteplan_collectiomn .oneplan").each(function(t){if($(this).data("largeimg")){var e={html:"<div class='siteplan_slide'><div id='sp_container_"+t+"' class='siteplan_container'><img src='"+normalizeURL($(this).data("largeimg"))+"' class='sp_img'/></div></div>",mapName:$(this).data("map-name"),commID:$(this).data("comm-id"),title:$("figcaption",this).text(),myID:t};i.push(e)}});var a={index:$(this).index(),preload:[0,0],allowPanToNext:!1,preventSwiping:!0,closeOnScroll:!1,isClickableElement:function(t){return console.log(t.tagName),console.log("IMG"===t.tagName),"IMG"===t.tagName}},l=new PhotoSwipe(e,PhotoSwipeUI_Default,i,a);l.listen("afterChange",function(){prepSitePlans(l.currItem)}),l.listen("beforeChange",function(){toll.sitePlan.abort()}),l.listen("destroy",function(){toll.sitePlan.abort()}),l.init()})});var prepSitePlans=function(t){toll.sitePlan.abort(),""!==t.mapName&&(spData=spByComm["comm_"+t.commID],sitePlanSelector="#sp_container_"+t.myID,spImg=$(sitePlanSelector+" .sp_img"),$("<img/>").attr("src",$(spImg).attr("src")).load(function(){pic_real_width=this.width,pic_real_height=this.height,pic_real_width+40>$(window).width()&&$(spImg).addClass("tooWide"),toll.sitePlan.loadWithPrefetchedData(t.commID,spData,!1),toll.sitePlan.init(t.mapName,sitePlanSelector,t.commID),toll.sitePlan.show()}))};